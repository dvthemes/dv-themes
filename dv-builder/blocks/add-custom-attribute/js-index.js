(()=>{var t,e={209:(t,e,r)=>{"use strict";const o=window.wp.element,a=window.wp.hooks,s=window.wp.blocks,n=window.wp.compose,l=window.wp.i18n,i=window.wp.blockEditor,c=window.wp.components,u=window.wp.primitives,b=(0,o.createElement)(u.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24"},(0,o.createElement)(u.Path,{d:"M4.2 9h1.5V5.8H9V4.2H4.2V9zm14 9.2H15v1.5h4.8V15h-1.5v3.2zM15 4.2v1.5h3.2V9h1.5V4.2H15zM5.8 15H4.2v4.8H9v-1.5H5.8V15z"})),d=(0,o.createElement)(u.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24"},(0,o.createElement)(u.Path,{d:"M12 4.75a7.25 7.25 0 100 14.5 7.25 7.25 0 000-14.5zM3.25 12a8.75 8.75 0 1117.5 0 8.75 8.75 0 01-17.5 0zM12 8.75a1.5 1.5 0 01.167 2.99c-.465.052-.917.44-.917 1.01V14h1.5v-.845A3 3 0 109 10.25h1.5a1.5 1.5 0 011.5-1.5zM11.25 15v1.5h1.5V15h-1.5z"})),m=({children:t,as:e="div",...r})=>(0,o.createElement)(e,{dangerouslySetInnerHTML:{__html:t},...r});let h;const p=h=()=>{const[t,e]=(0,o.useState)(!1);return(0,o.createElement)(o.Fragment,null,(0,o.createElement)(c.Button,{isSecondary:!0,className:"wsd-afb__button-help","aria-label":(0,l.__)("Show Attributes for Blocks help","attributes-for-blocks"),onClick:()=>e(!0),icon:d}),t&&(0,o.createElement)(c.Modal,{title:(0,l.__)("Attributes for Blocks help","attributes-for-blocks"),onRequestClose:()=>e(!1),className:"wsd-afb__help",style:{maxWidth:720}},(0,o.createElement)("div",{className:"wsd-afb__help__content"},(0,o.createElement)("h3",null,(0,l.__)("How do I add an attribute?","attributes-for-blocks")),(0,o.createElement)("p",null,(0,l.__)('Type an attribute name into the "Add attribute" field and press "Add" to add an attribute for the block. A new input with the attribute\'s name should appear below, into which you can optionally insert the attribute value.',"attributes-for-blocks")),(0,o.createElement)(m,{as:"p"},`\n\t\t\t\t\t\t\t${(0,l.__)("Example attributes: ","attributes-for-blocks")}\n\t\t\t\t\t\t\t<code>style</code>,\n\t\t\t\t\t\t\t<code>title</code>,\n\t\t\t\t\t\t\t<code>target</code>,\n\t\t\t\t\t\t\t<code>class</code>,\n\t\t\t\t\t\t\t<code>id</code>,\n\t\t\t\t\t\t\t<code>onClick</code>,\n\t\t\t\t\t\t\t<code>data-*</code>,\n\t\t\t\t\t\t\t<code>aria-*</code>.\n\t\t\t\t\t\t`),(0,o.createElement)("h3",null,(0,l.__)("How does it work?","attributes-for-blocks")),(0,o.createElement)(m,{as:"p"},`\n\t\t\t\t\t\t\t${(0,l.__)("For regular blocks, attributes are added to the block save content's root element, meaning they will be rendered only on the front end and not in the editor. For dynamic blocks the attributes are added via `render_callback` function and they may also be applied in the editor, depending if the block is rendered server or client side.","attributes-for-blocks")}\n\t\t\t\t\t\t`),(0,o.createElement)("h3",null,(0,l.__)("Does it work for every block?","attributes-for-blocks")),(0,o.createElement)(m,{as:"p"},`\n\t\t\t\t\t\t\t${(0,l.__)("It should work with normal blocks that render a valid WP Element that can utilize the `blocks.getSaveContent.extraProps` filter as well as dynamic blocks that utilize a `render_callback`. Third party blocks that do something unorthodox may not work.","attributes-for-blocks")}\n\t\t\t\t\t\t`),(0,o.createElement)("h3",null,(0,l.__)("Modes","attributes-for-blocks")),(0,o.createElement)("p",null,(0,l.__)("You can change between modes by clicking the button next to the input where the attribute value is specified.","attributes-for-blocks")),(0,o.createElement)("h4",null,(0,l.__)("Merge mode (default)","attributes-for-blocks")),(0,o.createElement)("p",null,(0,l.__)("In merge mode, when a block has already defined the attribute you're trying to add, the values are merged.","attributes-for-blocks")),(0,o.createElement)("h4",null,(0,l.__)("Override mode","attributes-for-blocks")),(0,o.createElement)("p",null,(0,l.__)("In override mode, when a block has already defined the attribute you're trying to add, the value is completely replaced with the provided value. You can switch between modes by clicking the intersecting arrows button next to the attribute input.","attributes-for-blocks")),(0,o.createElement)("h3",null,(0,l.__)("What happens when I disable this plugin?","attributes-for-blocks")),(0,o.createElement)("p",null,(0,l.__)('Blocks with custom attributes may become invalid, depending on which attributes you\'ve added. From there you can recover the block without the custom attributes by clicking "Attempt Block Recovery" or keep the block with custom attributes as HTML by choosing "Convert to HTML". If you don\'t want to risk blocks becoming invalid you need to remove all custom attributes before disabling the plugin.',"attributes-for-blocks")),(0,o.createElement)("h3",null,(0,l.__)("Common attributes","attributes-for-blocks")),(0,o.createElement)("h4",null,(0,l.__)("Style attribute","attributes-for-blocks")),(0,o.createElement)(m,{as:"p"},`\n\t\t\t\t\t\t\t${(0,l.__)("Inline styles can be defined as text.","attributes-for-blocks")}\n\t\t\t\t\t\t\t${(0,l.__)("Example:","attributes-for-blocks")} <code>color:red;font-weight:bold</code><br>\n\t\t\t\t\t\t\t${(0,l.__)("Spaces are allowed, leading or trailing semicolons are not needed.","attributes-for-blocks")}<br>\n\t\t\t\t\t\t\t${(0,l.__)("Styles are not rendered in the block editor.","attributes-for-blocks")}\n\t\t\t\t\t\t`),(0,o.createElement)("h5",null,(0,l.__)("Advanced editor","attributes-for-blocks")),(0,o.createElement)(m,{as:"p"},`\n\t\t\t\t\t\t\t${(0,l.__)('Style attribute can be edited with an advanced editor by clicking "Toggle editor".',"attributes-for-blocks")}\n\t\t\t\t\t\t`),(0,o.createElement)("h4",null,(0,l.__)("ID attribute","attributes-for-blocks")),(0,o.createElement)("p",null,(0,l.__)('If the block supports it, you should use the built-in "HTML anchor" feature instead.',"attributes-for-blocks")),(0,o.createElement)("h4",null,(0,l.__)("Class attribute","attributes-for-blocks")),(0,o.createElement)("p",null,(0,l.__)('HTML class attribute can be defined with the regular "class" or React\'s "className" attribute (non-dynamic blocks). Results (merging/overriding) may vary depending on the block. If the block supports it, you should use the built-in "Additional CSS Class" feature instead.',"attributes-for-blocks")))))};window.React;const f=r(848),k="-afb-placeholder",g="-afb-space",_=({toggleStyleEditor:t,resetStyles:e})=>(0,o.createElement)("p",{style:{marginBottom:0}},(0,o.createElement)("span",{style:{color:"red"}},(0,l.__)("Unable to parse styles.","attributes-for-blocks"))," ",(0,o.createElement)("a",{href:"#",onClick:t},(0,l.__)("Edit","attributes-for-blocks")),` ${(0,l.__)("or","attributes-for-blocks")} `,(0,o.createElement)("a",{href:"#",onClick:e},(0,l.__)("Clear value","attributes-for-blocks"))),y=t=>t.replaceAll(":","").replaceAll(";",""),v=(t,e=!0)=>{const r=()=>{const e=document.querySelector(t);null!==e&&e.focus()};e?setTimeout(r,50):r()},w=({value:t,onChange:e,toggleStyleEditor:r})=>{const[a,s]=(0,o.useState)(!1);let n;try{n=f(t)}catch(t){const a=t=>(t.preventDefault(),e(""),!1);return(0,o.createElement)(_,{toggleStyleEditor:r,resetStyles:a})}n||(n={[k]:k});const i=r=>{const o=Object.keys(r).map((t=>""===t?k:t)).map((t=>{let e=r[t]||k;return" "===e[e.length-1]&&(e=e.slice(0,-1)+g),`${t}: ${e};`})).join(" ");t!==o&&e(o)},u=Object.keys(n);return(0,o.createElement)(o.Fragment,null,u.map(((t,e)=>{const r=0===e,b=e+1===u.length,d=1===u.length,m=t===k&&n[t]===k;return(0,o.createElement)("div",{key:`rule-${e}`,className:"wsd-afb-action-input wsd-afb-style","data-index":e,"data-is-blank":m},(0,o.createElement)(c.TextControl,{placeholder:(0,l.__)("Property...","attributes-for-blocks"),value:t===k?"":t,onChange:e=>{""!==e&&u.includes(e)&&(e=`${e}-`,s(!0)),i(u.reduce(((r,o)=>(o===t?r[y(e)]=n[o]:r[o]=n[o],r)),{}))},onKeyDown:t=>{a&&("-"===t.key&&(t.preventDefault(),t.stopPropagation()),s(!1))},onKeyUp:t=>{"Enter"===t.key&&v(`.wsd-afb-style[data-index="${e}"] .components-base-control + .components-base-control input[type="text"]`,!1)}}),(0,o.createElement)(c.TextControl,{placeholder:(0,l.__)("Value...","attributes-for-blocks"),value:n[t]===k?"":n[t].replace(g," "),onChange:e=>{i({...n,[t]:y(e)})},onBlur:()=>{n[t].includes(g)&&i({...n,[t]:n[t].replace(g,"")})},onKeyUp:t=>{if("Enter"===t.code){const t=b&&!n.hasOwnProperty(k);t&&i({...n,[k]:k}),v(`.wsd-afb-style[data-index="${e+1}"] input[type="text"]`,t)}}}),(0,o.createElement)("div",{className:"wsd-afb-button-group"},(0,o.createElement)(c.Button,{className:"button icon-button","aria-label":(0,l.__)("Move up","attributes-for-blocks"),disabled:r,onClick:()=>i(u.filter((e=>e!==t)).reduce(((r,o,a)=>(a===e-1&&(r[t]=n[t]),r[o]=n[o],r)),{}))},(0,o.createElement)(c.Dashicon,{icon:"arrow-up"})),(0,o.createElement)(c.Button,{className:"button icon-button is-top-right","aria-label":(0,l.__)("Remove rule","attributes-for-blocks"),disabled:d&&m,onClick:()=>{const{[t]:e,...r}=n;i({...r,...d&&{[k]:k}})}},(0,o.createElement)(c.Dashicon,{icon:"no"})),(0,o.createElement)(c.Button,{className:"button icon-button","aria-label":(0,l.__)("Move down","attributes-for-blocks"),disabled:b,onClick:()=>i(u.filter((e=>e!==t)).reduce(((r,o,a)=>(r[o]=n[o],a===e&&(r[t]=n[t]),r)),{}))},(0,o.createElement)(c.Dashicon,{icon:"arrow-down"})),(0,o.createElement)(c.Button,{className:"button icon-button is-bottom-right","aria-label":(0,l.__)("Add rule","attributes-for-blocks"),disabled:t===k,onClick:()=>{if(b){const{[k]:t,...e}=n;i({...e,[k]:k})}else i(u.reduce(((t,r,o)=>(r===k||(t[r]=n[r],o===e&&(t[k]=k)),t)),{}));v('.wsd-afb-style[data-is-blank="true"] input[type="text"]')}},(0,o.createElement)(c.Dashicon,{icon:"plus"}))))})))};class E extends o.Component{constructor(){super(...arguments),this.state={adding:"",message:void 0,styleEditor:JSON.parse(localStorage.getItem("attributesForBlocks/styleEditor"))||!1,isFullscreen:!1},this.addAttribute=this.addAttribute.bind(this),this.removeAttribute=this.removeAttribute.bind(this),this.toggleAttributeMode=this.toggleAttributeMode.bind(this),this.toggleStyleEditor=this.toggleStyleEditor.bind(this)}componentDidUpdate(t,e){e.adding&&!this.state.adding&&setTimeout((()=>{"style"===e.adding&&this.state.styleEditor?document.querySelector('.wsd-afb-style input[type="text"]')?.focus():document.querySelector(`.wsd-afb-action-input#afb-${e.adding} input[type="text"]`)?.focus()}),150),e.styleEditor!==this.state.styleEditor&&localStorage.setItem("attributesForBlocks/styleEditor",this.state.styleEditor)}addAttribute(t){t.preventDefault();let{adding:e}=this.state;if(!e)return void this.setState({message:(0,l.__)("No attribute name specified.","attributes-for-blocks")});let{setAttributes:r}=this.props,{attributesForBlocks:o}=this.props.attributes;if(!o)return void this.setState({message:(0,l.__)("Unable to add attributes to block.","attributes-for-blocks")});let a=e.replace("@","");if(a in o||"@"+a in o)return this.setState({message:(0,l.__)("Attribute already exists","attributes-for-blocks")}),void document.querySelector(`.wsd-afb-action-input#afb-${a} input[type="text"]`).focus();r({attributesForBlocks:Object.assign({[e]:void 0},o,{[e]:""})}),this.setState({adding:"",message:void 0})}removeAttribute(t){let{setAttributes:e}=this.props,{attributesForBlocks:r}=this.props.attributes,o=Object.assign({},r);delete o[t],e({attributesForBlocks:o})}updateAttribute(t,e){let{setAttributes:r}=this.props,{attributesForBlocks:o}=this.props.attributes;r({attributesForBlocks:Object.assign({},o,{[t]:e})})}toggleAttributeMode(t){let{setAttributes:e}=this.props,{attributesForBlocks:r}=this.props.attributes,o="@"===t.substring(0,1)?t.substring(1):"@"+t;e({attributesForBlocks:((t,e,r)=>{let o={[t]:e};return Object.keys(r).reduce(((e,a)=>(o[a]?e[o[a]]=r[t]:e[a]=r[a],e)),{})})(t,o,r)})}toggleStyleEditor(t){if(this.setState({styleEditor:!this.state.styleEditor}),t)return t.preventDefault(),!1}render(){const{adding:t,isFullscreen:e}=this.state,{attributesForBlocks:r}=this.props.attributes,a=(0,o.createElement)(c.BaseControl,{className:"wsd-afb"},(0,o.createElement)(c.__experimentalVStack,{spacing:2},(0,o.createElement)("form",{className:"wsd-afb-action-input",onSubmit:this.addAttribute},!e&&(0,o.createElement)(c.Button,{className:"wsd-afb__button-full-screen","aria-label":(0,l.__)("Full screen","attributes-for-blocks"),icon:b,onClick:()=>this.setState({isFullscreen:!e})}),(0,o.createElement)(c.TextControl,{label:(0,l.__)("Additional attributes","attributes-for-blocks"),placeholder:(0,l.__)("Attribute name...","attributes-for-blocks"),value:t,onChange:t=>this.setState({adding:t,message:void 0})}),(0,o.createElement)(c.Button,{className:"wsd-afb__button-add is-last",variant:"primary",type:"submit","aria-label":(0,l.__)("Add attribute","attributes-for-blocks")},(0,l.__)("Add","attributes-for-blocks")),(0,o.createElement)(p,null)),(0,o.createElement)("p",{className:"wsd-afb-message"},this.state.message||" "),r&&Object.keys(r).map((t=>{const e=t.replace("@",""),a="@"===t.substring(0,1),s="style"===e.toLowerCase()&&this.state.styleEditor?"style":"default";return(0,o.createElement)(o.Fragment,{key:t},(0,o.createElement)("div",{id:`afb-${e}`,className:"wsd-afb-action-input"},"style"===e.toLowerCase()&&(0,o.createElement)("div",{className:"wsd-afb-action-link"},(0,o.createElement)("a",{href:"#",role:"button",onClick:this.toggleStyleEditor},(0,l.__)("Toggle editor","attributes-for-blocks"))),(0,o.createElement)(c.TextControl,{label:(0,o.createElement)(o.Fragment,null,(0,o.createElement)("strong",null,e),a&&" "+(0,l.__)("(override)","attributes-for-blocks")),disabled:"style"===s,value:r[t],onChange:e=>this.updateAttribute(t,e)}),(0,o.createElement)(c.Button,{className:"button icon-button","aria-label":(0,l.__)("Toggle between merge and override mode","attributes-for-blocks"),"aria-current":a?(0,l.__)("Override","attributes-for-blocks"):(0,l.__)("Merge","attributes-for-blocks"),onClick:()=>this.toggleAttributeMode(t)},(0,o.createElement)(c.Dashicon,{icon:"randomize"})),(0,o.createElement)(c.Button,{className:"button icon-button is-last","aria-label":(0,l.__)("Remove attribute","attributes-for-blocks")+": "+e,onClick:()=>this.removeAttribute(t)},(0,o.createElement)(c.Dashicon,{icon:"no-alt"}))),"style"===s&&(0,o.createElement)(w,{value:r[t],onChange:e=>this.updateAttribute(t,e),toggleStyleEditor:this.toggleStyleEditor}))}))));return(0,o.createElement)(i.InspectorAdvancedControls,null,e&&(0,o.createElement)(c.Modal,{title:(0,l.__)("Additional attributes","attributes-for-blocks"),onRequestClose:()=>this.setState({isFullscreen:!1}),className:"wsd-afb__full-screen",style:{minWidth:640}},(0,o.createElement)(c.__experimentalView,{className:"wsd-afb__full-screen__content"},a)),!e&&a)}}const A=E,S=(0,a.applyFilters)("afb.defaultEnabled",!0),C=t=>{const e=t.name||t;return!window.afbData.unsupportedBlocks.includes(e)&&(0,s.hasBlockSupport)(t,"attributesForBlocks",S)},x={attributesForBlocks:{type:"object",default:{}}},B=(0,n.createHigherOrderComponent)((function(t){return function(e){return C(e.name)?(0,o.createElement)(o.Fragment,null,(0,o.createElement)(t,{...e}),(0,o.createElement)(A,{...e})):(0,o.createElement)(t,{...e})}}),"withAttributesForBlocksInspectorControls");(0,a.addFilter)("blocks.registerBlockType","attributes-for-blocks/attributes",(function(t){return C(t)&&(t.attributes=Object.assign(t.attributes||{},x)),t})),(0,a.addFilter)("editor.BlockEdit","attributes-for-blocks/inspector-controls",B),(0,a.addFilter)("blocks.getSaveContent.extraProps","attributes-for-blocks/extra-props",((t,e,r)=>{if(C(e)){let{attributesForBlocks:e}=r;e&&Object.keys(e).forEach((r=>{"@"===r.substring(0,1)?t[r.substring(1)]=e[r]:t[r]=function(t,e,r){if(!e)return r;let o=" ";if("style"===t)switch(typeof e){case"object":let t={};return r.trim().split(";").forEach((e=>{if(e&&e.includes(":")){let r=e.split(":");t[r[0].trim()]=r[1].trim()}})),{...e,...t};case"string":";"!==e.trim().substring(e.length-1,e.length)&&";"!==r.trim().substring(0,1)&&(o=";")}return o=(0,a.applyFilters)("afb.attribute.separator",o,t,e,r),[e,r].join(o)}(r,t[r],e[r])}))}return t}))},139:t=>{var e=/\/\*[^*]*\*+([^/*][^*]*\*+)*\//g,r=/\n/g,o=/^\s*/,a=/^(\*?[-#/*\\\w]+(\[[0-9a-z_-]+\])?)\s*/,s=/^:\s*/,n=/^((?:'(?:\\'|.)*?'|"(?:\\"|.)*?"|\([^)]*?\)|[^};])+)/,l=/^[;\s]*/,i=/^\s+|\s+$/g,c="";function u(t){return t?t.replace(i,c):c}t.exports=function(t,i){if("string"!=typeof t)throw new TypeError("First argument must be a string");if(!t)return[];i=i||{};var b=1,d=1;function m(t){var e=t.match(r);e&&(b+=e.length);var o=t.lastIndexOf("\n");d=~o?t.length-o:d+t.length}function h(){var t={line:b,column:d};return function(e){return e.position=new p(t),_(),e}}function p(t){this.start=t,this.end={line:b,column:d},this.source=i.source}p.prototype.content=t;var f=[];function k(e){var r=new Error(i.source+":"+b+":"+d+": "+e);if(r.reason=e,r.filename=i.source,r.line=b,r.column=d,r.source=t,!i.silent)throw r;f.push(r)}function g(e){var r=e.exec(t);if(r){var o=r[0];return m(o),t=t.slice(o.length),r}}function _(){g(o)}function y(t){var e;for(t=t||[];e=v();)!1!==e&&t.push(e);return t}function v(){var e=h();if("/"==t.charAt(0)&&"*"==t.charAt(1)){for(var r=2;c!=t.charAt(r)&&("*"!=t.charAt(r)||"/"!=t.charAt(r+1));)++r;if(r+=2,c===t.charAt(r-1))return k("End of comment missing");var o=t.slice(2,r-2);return d+=2,m(o),t=t.slice(r),d+=2,e({type:"comment",comment:o})}}function w(){var t=h(),r=g(a);if(r){if(v(),!g(s))return k("property missing ':'");var o=g(n),i=t({type:"declaration",property:u(r[0].replace(e,c)),value:o?u(o[0].replace(e,c)):c});return g(l),i}}return _(),function(){var t,e=[];for(y(e);t=w();)!1!==t&&(e.push(t),y(e));return e}()}},848:(t,e,r)=>{var o=r(139);function a(t,e){var r,a=null;if(!t||"string"!=typeof t)return a;for(var s,n,l=o(t),i="function"==typeof e,c=0,u=l.length;c<u;c++)s=(r=l[c]).property,n=r.value,i?e(s,n,r):n&&(a||(a={}),a[s]=n);return a}t.exports=a,t.exports.default=a}},r={};function o(t){var a=r[t];if(void 0!==a)return a.exports;var s=r[t]={exports:{}};return e[t](s,s.exports,o),s.exports}o.m=e,t=[],o.O=(e,r,a,s)=>{if(!r){var n=1/0;for(u=0;u<t.length;u++){r=t[u][0],a=t[u][1],s=t[u][2];for(var l=!0,i=0;i<r.length;i++)(!1&s||n>=s)&&Object.keys(o.O).every((t=>o.O[t](r[i])))?r.splice(i--,1):(l=!1,s<n&&(n=s));if(l){t.splice(u--,1);var c=a();void 0!==c&&(e=c)}}return e}s=s||0;for(var u=t.length;u>0&&t[u-1][2]>s;u--)t[u]=t[u-1];t[u]=[r,a,s]},o.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),(()=>{var t={826:0,431:0};o.O.j=e=>0===t[e];var e=(e,r)=>{var a,s,n=r[0],l=r[1],i=r[2],c=0;if(n.some((e=>0!==t[e]))){for(a in l)o.o(l,a)&&(o.m[a]=l[a]);if(i)var u=i(o)}for(e&&e(r);c<n.length;c++)s=n[c],o.o(t,s)&&t[s]&&t[s][0](),t[s]=0;return o.O(u)},r=self.webpackChunkattributes_for_blocks=self.webpackChunkattributes_for_blocks||[];r.forEach(e.bind(null,0)),r.push=e.bind(null,r.push.bind(r))})();var a=o.O(void 0,[431],(()=>o(209)));a=o.O(a)})();